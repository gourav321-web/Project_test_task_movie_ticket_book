<h2 class="page-title">Available Shows</h2>

<%= form_with(url: search_show_movie_shows_path(@movie), method: :get, local: true) do |form| %>
  <div class="search-bar shows-search">

    <div class="field">
      <label>Search by Date</label>
      <%= form.date_field :date, min: Date.today %>
    </div>

    <div class="field">
      <label>Search by Time</label>
      <%= form.time_field :time %>
    </div>

    <div class="field search-btn">
      <%= form.submit "Search Shows" %>
    </div>

  </div>
<% end %>

<% if @shows.any? %>
  <div class="shows-container">
    <% @shows.each do |show| %>
      <div class="show-card">
        <p class="show-time">
          <%= show.show_time.strftime("%d %b %Y, %I:%M %p") %>
        </p>

        <p>Seats: <strong><%= show.available_seats %></strong></p>
        <p>Price: <strong>â‚¹<%= show.seat_price %></strong></p>

        <%= link_to "Book Now", new_show_booking_path(show), class: "book-btn" %>
      </div>
    <% end %>
  </div>
<% else %>
  <h3 class="no-shows">No shows available for this movie.</h3>
<% end %>


<div class= "flex-css">
  <nav class="add-show-btn">
    <%= link_to "Back to Movies", movies_path %>
  </nav>

  <% if current_user.role == "admin" %>
    <div class="add-show-btn">
      <%= link_to "Add Show", new_movie_show_path(@movie) %>
    </div>

    <div class="add-show-btn">
      <%= link_to "Edit Movie", edit_movie_path(@movie) %>
    </div>


    <div class="add-movie-btn">
      <%= link_to "Delete Movie",
        movie_path(@movie),
        data: {
          turbo_method: :delete,
          turbo_confirm: "Are you sure?"
        } 
      %>
    </div>
  <%end%>
</div>